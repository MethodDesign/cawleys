  const logoSvg =
		'<svg viewBox="0 0 113 57" xmlns="http://www.w3.org/2000/svg"><g class="text"><path d="M27.963 20.266v3.595c-1.759-1.469-3.577-2.204-5.457-2.205a6.94 6.94 0 0 0-5.233 2.233c-1.428 1.478-2.142 3.288-2.143 5.429 0 2.114.714 3.898 2.143 5.351 1.428 1.454 3.177 2.181 5.247 2.181 1.07 0 1.979-.175 2.728-.523.454-.194.888-.43 1.298-.705.492-.329.965-.686 1.417-1.069v3.673a10.959 10.959 0 0 1-5.484 1.483c-2.879 0-5.338-1.004-7.378-3.011-2.025-2.03-3.038-4.476-3.037-7.339 0-2.568.848-4.857 2.545-6.866 2.09-2.464 4.792-3.695 8.107-3.694a10.33 10.33 0 0 1 5.247 1.467M40.611 26.628h2.949v12.715h-2.949V38.01c-1.205 1.132-2.506 1.699-3.903 1.699-1.759 0-3.212-.636-4.359-1.907-1.142-1.297-1.712-2.915-1.711-4.856 0-1.907.57-3.495 1.711-4.764a5.505 5.505 0 0 1 4.28-1.906c1.479 0 2.806.609 3.982 1.828v-1.476Zm-6.97 6.324c0 1.218.326 2.21.978 2.976a3.204 3.204 0 0 0 2.533 1.162c1.087 0 1.966-.374 2.636-1.122.669-.776 1.004-1.759 1.006-2.951.002-1.191-.333-2.174-1.006-2.949a3.327 3.327 0 0 0-2.61-1.136 3.246 3.246 0 0 0-2.533 1.149c-.671.77-1.005 1.725-1.004 2.865v.006ZM49.095 26.629l3.329 7.257 3.588-8.418 3.614 8.418 3.291-7.257h3.289l-6.658 13.667-3.536-8.185-3.577 8.185-6.644-13.667h3.304ZM68.434 17.296h2.936v22.047h-2.936zM86.661 33.678h-9.117c.08 1.044.42 1.875 1.02 2.492.599.618 1.369.922 2.309.914a3.015 3.015 0 0 0 1.816-.521c.468-.349 1.003-.993 1.604-1.933l2.481 1.384a9.956 9.956 0 0 1-1.213 1.677 6.484 6.484 0 0 1-1.372 1.149 5.498 5.498 0 0 1-1.58.66 7.747 7.747 0 0 1-1.84.209c-1.897 0-3.419-.61-4.568-1.828-1.148-1.219-1.723-2.846-1.724-4.883 0-2.008.557-3.635 1.671-4.882 1.124-1.225 2.611-1.839 4.463-1.84 1.873 0 3.354.597 4.441 1.789 1.087 1.193 1.626 2.833 1.617 4.921l-.008.692Zm-3.011-2.409c-.408-1.566-1.395-2.349-2.962-2.349a3.023 3.023 0 0 0-1.006.165c-.31.105-.6.263-.856.468a2.989 2.989 0 0 0-.658.738c-.19.302-.331.632-.419.978h5.901ZM93.425 36.98l-5.722-10.351h3.408l3.899 7.31 3.628-7.31h3.312L91.818 46.262h-3.353l4.96-9.282ZM111.334 28.795l-2.429 1.294c-.384-.776-.857-1.163-1.423-1.163a.98.98 0 0 0-.691.267.905.905 0 0 0-.288.685c0 .487.566.969 1.697 1.447 1.558.67 2.607 1.287 3.147 1.852.54.565.81 1.325.809 2.281a3.993 3.993 0 0 1-1.355 3.076 4.629 4.629 0 0 1-3.185 1.175c-2.132 0-3.642-1.041-4.531-3.122l2.509-1.161c.346.603.613.997.795 1.161.345.327.805.506 1.28.497.992 0 1.487-.451 1.487-1.355 0-.523-.382-1.01-1.148-1.46a32.69 32.69 0 0 0-.889-.431c-.296-.139-.594-.283-.903-.432-.852-.418-1.455-.835-1.807-1.253-.444-.532-.666-1.216-.666-2.052a3.622 3.622 0 0 1 1.136-2.741 3.987 3.987 0 0 1 2.818-1.084c1.633 0 2.845.84 3.637 2.519"/></g><g class="shape"><path d="M1.496 27.272a2.52 2.52 0 1 1-.007.003l.007-.003M52.525 14.482A28.03 28.03 0 0 0 23.581.35C10.529 2.428 1.034 13.205.05 25.826a3.012 3.012 0 0 1 5.2.536c.044.109.081.22.11.333 1.23-9.9 8.471-18.115 18.334-19.684.102-.017.203-.027.301-.041.098-.013.244-.048.366-.066a22.368 22.368 0 0 1 2.409-.248 18.015 18.015 0 0 1 2.587.025c.602.042 1.185.106 1.763.196 6.625.893 12.378 4.761 15.447 10.593l-2.283 1.147 8.012 2.651 2.662-8.005-2.433 1.219ZM2.005 33.915a2.389 2.389 0 1 1-.458 3.346l-.003-.003a2.391 2.391 0 0 1 .461-3.343M4.409 39.701a2.259 2.259 0 1 1-.431 3.165l-.002-.003a2.258 2.258 0 0 1 .433-3.162M7.045 45.937a2.12 2.12 0 1 1-.001.006l.001-.006M11.594 49.918a1.91 1.91 0 1 1 1.597 2.177h-.002a1.911 1.911 0 0 1-1.595-2.177M16.177 52.432a1.857 1.857 0 1 1 3.67.575 1.857 1.857 0 0 1-3.67-.575M21.014 53.964a1.723 1.723 0 1 1-.001.005l.001-.005M25.622 54.61a1.592 1.592 0 1 1 3.147.491 1.592 1.592 0 1 1-3.147-.491M30.104 55.015a1.458 1.458 0 1 1 2.908-.212 1.458 1.458 0 0 1-2.908.212M33.949 54.353a1.323 1.323 0 1 1 .001.011l-.001-.011M37.409 53.817a1.194 1.194 0 1 1 1.553.665l-.003.001a1.193 1.193 0 0 1-1.55-.666M40.287 52.52a1.054 1.054 0 1 1 .005.012l-.005-.012M43.446 51.4a.926.926 0 1 1 .769-1.687.927.927 0 0 1-.766 1.689l-.003-.002M45.857 49.612a.797.797 0 1 1 .656-1.452.797.797 0 0 1-.656 1.452M47.9 47.91a.663.663 0 1 1 .003.002l-.003-.002M49.538 45.932a.53.53 0 1 1 .44-.965.53.53 0 0 1-.44.965M50.812 44.235a.398.398 0 1 1 .003.001l-.003-.001M51.844 42.938a.265.265 0 1 1 .31-.21v.002a.264.264 0 0 1-.31.208"/></g></svg>';
  document.querySelector('.header-display-desktop .header-title-logo a').innerHTML += logoSvg;
  document.querySelector('.header-display-mobile .header-title-logo a').innerHTML += logoSvg;
  document.querySelector('#footer-sections .footer-logo').innerHTML += logoSvg;
  
document.addEventListener('DOMContentLoaded', runFunctions);

document.addEventListener('DOMContentLoaded', runFunctions);

  function runFunctions(){

	// VARIABLES

	const $$ = document.querySelectorAll.bind(document),
		  path = window.location.pathname,
		  aceArray = [],
		  body = document.body,
		  pageSections = $$('#page .page-section'),
		  footerSections = $$('#footer-sections .page-section'),
		  header = document.getElementById('header'),
		  headerChildren = header.children,
		  footer = document.getElementById('footer-sections'),
		  scrollPosY = window.scrollY,
		  caseStudyCollectionId = 'collection-620e3d4c1fadd45a416ec29e',
		  newsCollectionId = 'collection-620cf3cfc199dd163bf4a6fb';
	let adminUser = false,
		fragment = document.createDocumentFragment(),
		windowWidth = window.innerWidth,
		windowHeight,
		headerHeight;
	if(document.documentElement.hasAttribute('data-authenticated-account')) adminUser = true;

	// TRIGGER FUNCTIONS ON LOAD

	navFunction(document.querySelector('.header-nav-item--external + .header-nav-item'))
	updateglobalsizesFunction()
	headerbackgroundFunction()
	acefeaturesFunction(footerSections, "Footer")
	acefeaturesFunction(pageSections, "On-Page")
	console.log('custom stuff:', aceArray);
	gallerycaptionFunction($$('.gallery-fullscreen-slideshow figcaption'))
	galleryblockFunction($$('.gallery-block'))
	summaryblockFunction($$('.summary-v2-block'))
	doublebuttonFunction($$('.button-block + .button-block'))
	formplaceholdersFunction($$('.form-block .field'))
	archiveblockFunction($$('.archive-block li'))
	customfeaturesFunction(aceArray)
	if(body.id !== newsCollectionId && body.classList.contains(newsCollectionId)) blogshareFunction()
	if(body.id === caseStudyCollectionId) casestudylistFunction($$('.blog-more-link'))
	if(body.id !== caseStudyCollectionId && body.classList.contains(caseStudyCollectionId)) casestudypostFunction()
	// quote and contact pages
	if(body.id === 'collection-6220f1ed0ded414d2a411efb' || body.id === 'collection-622226a4a80b6e4d05c1856c') formblocksplitFunction(document.querySelector('.form-block .field-list'))
	/*if (!adminUser) {
	  sidebysideFunction($$('.page-section.side-by-side'))
	}*/

	// TRIGGER FUNCTIONS ON RESIZE

	window.addEventListener('resize', debounce(function (e) {
	  if (!windowWidth === window.innerWidth) {
		updateglobalsizesFunction();
		windowWidth = window.innerWidth;
	  }
	}));

	// FUNCTIONS

	function updateglobalsizesFunction() {
	  windowHeight = window.innerHeight;
	  headerHeight = (function(){
		let childrenHeight = 0;
		for (let i = 1; i < 3; i++) {
		  childrenHeight += headerChildren[i].getBoundingClientRect().height;
		}
		return childrenHeight;
	  })();
	  document.documentElement.style.setProperty('--window-height', windowHeight + 'px');
	  document.documentElement.style.setProperty('--header-height', headerHeight + 'px');
	} // end get window and header heights function
	
	function headerbackgroundFunction(){
	  const firstSectionClassList = pageSections[0].classList,
			secondaryNav = header.querySelector('.secondary-nav'),
			observer = new IntersectionObserver(entries => {
			  console.log(entries)
			  if (entries[0].isIntersecting) header.classList.remove('scrolled')
			  else header.classList.add('scrolled');
			});
	  observer.observe(secondaryNav);
	  if(!firstSectionClassList.contains('has-background') && (firstSectionClassList.contains('gallery-section') ? !firstSectionClassList.contains('full-bleed-section') : true)) body.classList.add('first-section-no-background')
	} // end hide header background if first section has background or is full-bleed gallery

	function navFunction(secondaryNavItem){
	  let navItems = [],
		  secondaryNav = document.createElement('nav');
	  fragment.appendChild(secondaryNav);
	  secondaryNav.className = 'secondary-nav header-nav-list header-nav-wrapper header-layout-nav-right';
	  while (secondaryNavItem){
		navItems.push(secondaryNavItem);
		secondaryNavItem = secondaryNavItem.nextElementSibling;
	  }
	  navItems.map(element => secondaryNav.appendChild(element));
	  header.insertBefore(secondaryNav, header.querySelector('.header-announcement-bar-wrapper'));
	} // end create secondary nav

	function checkscrollpositionFunction() {
	  if (scrollPosY > 10) header.classList.add('shrink')
	} // end checkscrollposition

	function acefeaturesFunction(sections, area) {
		console.log(area);
	  let previousTheme;
	  sections.forEach((section,index) => {
		const nextElement = section.nextElementSibling,
			  embedBlocks = section.querySelectorAll('.embed-block'),
			  sectionStyles = JSON.parse(section.dataset.currentStyles),
			  sectionTheme = sectionStyles.sectionTheme ? sectionStyles.sectionTheme.split('-')[0] : 'white',
			  sectionBackground = section.querySelector('.section-background'),
			  sectionBackgroundOverlay = sectionBackground.querySelector('.section-background-overlay'),
			  sectionColour = window.getComputedStyle(section).color,
			  sectionBackgroundColour = sectionBackgroundOverlay ? window.getComputedStyle(sectionBackgroundOverlay).backgroundColor : window.getComputedStyle(sectionBackground).backgroundColor;
		// styles
		section.style.setProperty('--section-colour', sectionColour);
		section.style.setProperty('--section-background-colour', sectionBackgroundColour);
		if(sectionStyles.backgroundMode === 'video') section.classList.add('has-background')
		if(sectionStyles.sectionHeight === 'section-height--custom') section.classList.add('section-height--custom')
		// theming
		section.setAttribute('data-theme', sectionTheme);
		if(sections[index-1] && sectionTheme === previousTheme) sections[index-1].classList.add('next-section-same-theme')
		previousTheme = sectionTheme;
		// custom features
		if(!embedBlocks) return
		embedBlocks.forEach(embedBlock => {
		  const customSettings = JSON.parse('{'+embedBlock.textContent+'}'),
				features = customSettings.features.split(' ')
		  customSettings.features = features;
		  //console.log("james")
		  console.log(customSettings.features)
		  customSettings.element = embedBlock;
		  aceArray.push(customSettings)
		});
	  });
	} // end ace features
	
	function customfeaturesFunction(customFeaturesArray){
	  customFeaturesArray.forEach(itemJson => {
		const features = itemJson.features,
			  embedElement = itemJson.element,
			  featureSection = embedElement.closest('.page-section');
		console.log('features:', features)
		features.forEach(feature => {
		  if(embedElement.previousElementSibling) embedElement.previousElementSibling.classList.add(feature);
		  featureSection.classList.add('has-'+feature);
		  switch (feature) {
			case 'plugin':
			  pluginFunction(itemJson)
			  break
			case 'grid':
			  gridFunction(itemJson)
			  break
			case 'slider':
			  sliderFunction(itemJson)
			  break
			case 'services-list':
			  serviceslistFunction(itemJson)
			  break
			default:
			  break
		  }
		});
		if(!adminUser) embedElement.remove()
	  });
	}

	function pluginFunction(itemJson) {
	 console.log("Plugin function",  )
	  var pluginName = itemJson['plugin-name'],
		  embedElement = itemJson.element,
		  pluginElement = embedElement.previousElementSibling ? embedElement.previousElementSibling : embedElement.closest('.sqs-layout');
		 console.log("Review: "+pluginName);
		 console.log("Element: "+pluginElement);
	  if(!window[pluginName]) {
		pluginElement.classList.add(pluginName)
		window[pluginName] = pluginElement;
	  }
	  else if(window[pluginName].classList.contains('sqs-layout') && !adminUser){
		pluginElement.parentElement.insertBefore(window[pluginName], pluginElement)
		pluginElement.remove();
	  } else if(!adminUser){
		embedElement.parentElement.insertBefore(window[pluginName], embedElement)
	  }
	}
	
	function gridFunction(itemJson){
	  const galleryBlock = itemJson.element.previousElementSibling,
			gridColumns = itemJson['grid-columns'],
			gridGap = itemJson['grid-gap'];
	  if(gridColumns) galleryBlock.style.setProperty('--grid-columns',gridColumns)
	  if(gridGap) galleryBlock.style.setProperty('--grid-gap',gridGap)
	} // end custom grid using stacked gallery block

	function sliderFunction(itemJson){
		console.log("Slider Function");
	  const sliderBlock = itemJson.element.previousElementSibling,
			defaultSplideOptions = {
			  type: 'slide',
			  arrows: true,
			  arrowPath: 'M10.222,39.488l22.702,-19.504l-22.704,-19.473c-0.798,-0.684 -2.001,-0.592 -2.685,0.206c-0.685,0.798 -0.593,2.001 0.205,2.686l19.335,16.583c0,0 -19.336,16.612 -19.336,16.612c-0.797,0.685 -0.889,1.889 -0.203,2.686c0.685,0.798 1.888,0.889 2.686,0.204Z',
			  pagination: false,
			  breakpoints: {
				640: {
				  perPage: 1,
				}
			  }
			},
			customSplideOptions = itemJson['slider-options'],
			sliderBlockClasses = sliderBlock.classList,
			sliderType = sliderBlockClasses.contains('gallery-block') ? 'gallery' : 
	  sliderBlockClasses.contains('summary-v2-block') ? 'summary' : 
	  sliderBlockClasses.contains('markdown-block') ? 'list' : undefined,
			itemsParent = sliderType === 'gallery' ? sliderBlock.querySelector('.sqs-gallery') : 
	  sliderType === 'summary' ? sliderBlock.querySelector('.summary-item-list') : 
	  sliderType === 'list' ? sliderBlock.querySelector('ul') : undefined,
			splideContainer = sliderType === 'gallery' ? sliderBlock.querySelector('.sqs-gallery-container') : 
	  sliderType === 'summary' ? sliderBlock.querySelector('.summary-block-wrapper') : 
	  sliderType === 'list' ? sliderBlock.querySelector('.sqs-block-content') : undefined,
			splideWrapper = document.createElement('div'),
			splideTrack = document.createElement('div'),
			splideList = itemsParent.cloneNode(true),
			splideSlides = [...splideList.children],
			gap = customSplideOptions && customSplideOptions.gap ? customSplideOptions.gap : sliderBlock.dataset.gutter ? sliderBlock.dataset.gutter : '20px',
			perPage = customSplideOptions && customSplideOptions.perPage ? customSplideOptions.perPage : sliderBlock.dataset.columns ? sliderBlock.dataset.columns : '3';
	  sliderBlock.style.setProperty('--gap', gap)
	  fragment.appendChild(splideWrapper)
	  splideWrapper.appendChild(splideTrack)
	  splideTrack.appendChild(splideList)
	  if(customSplideOptions) splideWrapper.setAttribute('data-splide', JSON.stringify(customSplideOptions));
	  else splideWrapper.setAttribute('data-splide', '{"gap":"'+gap+'","perPage":'+perPage+'}');
	  splideWrapper.classList.add('splide')
	  splideTrack.classList.add('splide__track')
	  splideList.classList.add('splide__list')
	  splideContainer.prepend(splideWrapper)
	  splideSlides.forEach(splideSlide => {
		const image = splideSlide.querySelector('img');
		splideSlide.classList.add('splide__slide')
		if(image) imageloaderFunction(image, null)
	  });
	  const splide = new Splide(splideWrapper, defaultSplideOptions);
	  splide.mount();
	} // end slider function
	
	function serviceslistFunction(itemJson){
	  const servicesBlock = itemJson.element.previousElementSibling,
			servicesList = servicesBlock.querySelector('ul'),
			serviceItem = servicesList.children[0];
	  servicesBlock.classList.add('services-list')
	  if(!servicesBlock.classList.contains('code-block')) return;
	  const servicesFolder = header.querySelector('.header-nav-item--folder .header-nav-folder-title[href="/services-folder"] + .header-nav-folder-content').cloneNode(true),
			services = servicesFolder.querySelectorAll('a');
	  services.forEach(service => {
		const serviceItemClone = serviceItem.cloneNode(true);
		serviceItemClone.appendChild(service)
		servicesList.appendChild(serviceItemClone)
	  });
	}

	function galleryblockFunction(galleryBlocks){
	  galleryBlocks.forEach(gallery => {
		const galleryProps = JSON.parse(gallery.dataset.blockJson),
			  imageWrappers = gallery.querySelectorAll('.image-wrapper, .slide');
		if(galleryProps.design === 'stacked') stackedgallerymetaFunction()
		if(galleryProps.collectionId === '6227327b1706782513443f14') timelinegalleryFunction()
		
		// gallery block functions
		
		function stackedgallerymetaFunction(){
		  const metaClass = 'meta';
		  imageWrappers.forEach(imageWrapper => {
			const meta = imageWrapper.nextElementSibling;
			if(meta && meta.classList.contains(metaClass)) imageWrapper.appendChild(meta)
		  });
		} // end move stacked gallery item meta into image wrapper container
		
		function timelinegalleryFunction(){
		  gallery.classList.add('timeline')
		  const imageContainer = document.createElement('div');
		  fragment.appendChild(imageContainer).classList.add('image-container')
		  imageWrappers.forEach(imageWrapper => {
			const imageContainerClone = imageContainer.cloneNode(true),
				  image = imageWrapper.querySelector('img');
			imageContainerClone.appendChild(image)
			imageWrapper.prepend(imageContainerClone)
		  });
		}
		
	  }); // end each gallery block
	} // end gallery block function
	
	function gallerycaptionFunction(imageCaptions) {
	  imageCaptions.forEach(caption => {
		const captionWrapper = caption.querySelector('.gallery-caption-wrapper'),
			  captionText = captionWrapper.querySelector('.gallery-caption-content'),
			  textLines = captionText.textContent.split('\n'),
			  textLinesLength = textLines.length,
			  imageLink = caption.previousElementSibling.getAttribute('href');
		textLines.forEach(function(textLine,i){
		  if(i == 0) captionWrapper.innerHTML = '<h1>'+textLine+'</h1>';
		  else if(i == textLinesLength - 1 && imageLink) captionWrapper.innerHTML += '<a href="'+imageLink+'" class="sqs-block-button-element sqs-button-element--primary">' + textLine + '</a>';
		  else captionWrapper.innerHTML += '<p>'+textLine+'</p>';
		});
	  }); // end for each caption
	} // end gallery captions
	
	function summaryblockFunction(blocks) {
	  blocks.forEach(block => {
		let summaryProps = JSON.parse(block.dataset.blockJson),
			itemsParent = block.querySelector('.summary-item-list'),
			summaryCollectionId = summaryProps.collectionId;
		if (summaryProps.design === 'autogrid') summarygridFunction()
		const items = block.querySelectorAll('.summary-item'),
			  showReadMoreLink = summaryProps.showReadMoreLink,
			  readMoreText = 'Read More'
		items.forEach(item => {
		  const itemLink = item.querySelector('a');
		  if(showReadMoreLink) item.querySelector('.summary-read-more-link').textContent = readMoreText;
		  if(!itemLink) return;
		  const itemUrl = itemLink.getAttribute('href');
		  if(itemUrl === path) {
			item.closest('.summary-item-list').classList.add('item-removed')
			item.remove();
		  }
		});
		
		// summary functions

		function summarygridFunction(){
		  const columsAndGutterObj = getcolumnsandgutterFunction();
		  block.style.setProperty('--aspect-ratio',100 / summaryProps.imageAspectRatio + '%')
		  block.setAttribute('data-columns', columsAndGutterObj.columns)
		  block.setAttribute('data-gutter', columsAndGutterObj.gutter + 'vw')
		  block.style.setProperty('--columns', columsAndGutterObj.columns)
		  block.style.setProperty('--gutter', columsAndGutterObj.gutter + 'vw')
		} // end summary grid function

		function getcolumnsandgutterFunction(){
		  const columsAndGutterObj = {
			columns: Math.floor(summaryProps.columnWidth * 0.01),
			// gutter 0-24 = 2vw, 25-49 = 4vw, 50-74 = 6vw, 75-99 = 8vw, 100 = 10vw
			gutter: Math.ceil((summaryProps.gutter + 1) / 25) * 2
			// columns 100-199 = 1, 200-299 = 2, 300-399 = 3, 400-499 = 4 etc
		  };
		  return columsAndGutterObj;
		} // end get columns and gutter function

	  }); // end each summary block
	} // end summary blocks function
	
	function doublebuttonFunction(button2s){
	  const buttonsContainer = document.createElement('div');
	  fragment.appendChild(buttonsContainer)
	  buttonsContainer.classList.add('buttons-container')
	  button2s.forEach(button2 => {
		const buttonsContainerClone = buttonsContainer.cloneNode(true),
			  button1 = button2.previousElementSibling,
			  buttonsParent = button2.parentElement;
		buttonsContainerClone.appendChild(button1)
		buttonsParent.insertBefore(buttonsContainerClone, button2)
		buttonsContainerClone.appendChild(button2)
	  });
	} // end double buttons

	function formplaceholdersFunction(formFields) {
	  formFields.forEach(field => {
		let label,
			labelText,
			input;
		if(field.classList.contains('checkbox')) return
		if (field.classList.contains('form-item')) {
		  label = field.querySelector('label');
		  labelText = label.textContent.replace(/\s+/g, ' ').trim();
		  input = label.nextElementSibling;
		} else {
		  const fieldSet = field.closest('fieldset');
		  label = field.querySelector('.caption-text');
		  labelText = label.textContent.replace(/\s+/g, ' ').trim();
		  if (fieldSet.classList.contains('required')) labelText += ' *'
		  input = field.querySelector('input');
		}
		if(!(input instanceof HTMLSelectElement)) input.placeholder = labelText;
		else {
		  const selectPlaceholder = document.createElement('option');
		  selectPlaceholder.disabled = true;
		  selectPlaceholder.selected = true;
		  selectPlaceholder.textContent = labelText;
		  input.prepend(selectPlaceholder)
		}
	  });
	} // end form placeholders
	
	function formblocksplitFunction(fieldList){
	  const fields = Array.from(fieldList.children),
			textAreaIndex = fields.findIndex(item => item.classList.contains('textarea')),
			fieldSet1 = fields.slice(1,textAreaIndex),
			fieldSet2 = fields.slice(textAreaIndex),
			column1 = document.createElement('div');
	  fragment.appendChild(column1)
	  column1.classList.add('form-col')
	  const column2 = column1.cloneNode(true);
	  column1.append(...fieldSet1)
	  column2.append(...fieldSet2)
	  fieldList.appendChild(column1)
	  fieldList.appendChild(column2)      
	} // end split form block on quote/contact pages for side-by-side layout
	
	function archiveblockFunction(archiveItems){
	  archiveItems.forEach(item => {
		const link = item.querySelector('a'),
			  href = link.getAttribute('href');
		if(href != path) return;
		item.classList.add('active')
		link.setAttribute('href','/'+href.split('/')[1])
	  });
	} // end if item in archive block is for current page, mark as active
	
	function casestudylistFunction(postLinks){
	  const linkText = 'Download PDF';
	  postLinks.forEach(link => {
		link.textContent = linkText;
	  });
	} // end function to change 'read more' post links to 'Download PDF'

	function casestudypostFunction(){
	  const postJson = path + '?format=json';
	  fetch(postJson)
		.then(r => r.json())
		.then(data => {
		console.log(data);
		const postImage = data.item.assetUrl,
			  postTitle = data.item.title,
			  postBannerSection = document.createElement('section'),
			  sectionInner = '<div class="section-background"><img data-src="'+ postImage +'"></div><div class="content-wrapper"><div class="content"><div class="sqs-layout sqs-grid-12 columns-12" data-type="page-section"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2"><div class="sqs-block-content"><h1>'+ postTitle +'</h1></div></div></div></div></div></div></div>';
		fragment.appendChild(postBannerSection)
		postBannerSection.className = 'page-section layout-engine-section background-width--full-bleed content-width--narrow horizontal-alignment--left vertical-alignment--bottom has-background dark';
		postBannerSection.innerHTML = sectionInner;
		document.getElementById('sections').prepend(postBannerSection)
		body.classList.remove('first-section-no-background')
		imageloaderFunction(postBannerSection.querySelector('.section-background img'))
	  }).catch(e => console.log(e));
	} // end fetch post page json to get image and create banner section

	function blogshareFunction() {
	  const sharePos = document.querySelector('section.content-collection'),
			shareDiv = document.createElement('div'),
			addThisHtml = '<div class="addthis_inline_share_toolbox"></div>';
	  fragment.appendChild(shareDiv);
	  shareDiv.classList.add('blog-share-buttons')
	  shareDiv.innerHTML = '<p class="sqsrte-small">Share:</p>' + addThisHtml;
	  sharePos.appendChild(shareDiv);
	} // end blog share

	function imageloaderFunction(image, mode) {
	  setTimeout(function () {
		window.ImageLoader.load(image, {
		  load: true,
		  mode: mode
		});
		image.classList.add('loaded')
	  }, 100);
	} // end imageloader

	function debounce(func) {
	  var timer;
	  return function (event) {
		if (timer) clearTimeout(timer);
		timer = setTimeout(func, 500, event);
	  };
	}

  } // end run functions

  document.addEventListener('DOMContentLoaded', function () {
	  setTimeout(function () {
		document.body.classList.add('ready')
	  }, 400);
	});